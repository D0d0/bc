(function(a){if(typeof define==="function"&&define.amd){define(["jquery"],a)}else{a(window.jQuery)}}(function(g){if("function"!==typeof Array.prototype.reduce){Array.prototype.reduce=function(I,H){var D,F,E=this.length>>>0,G=false;if(1<arguments.length){F=H;G=true}for(D=0;E>D;++D){if(this.hasOwnProperty(D)){if(G){F=I(F,this[D],D,this)}else{F=this[D];G=true}}}if(!G){throw new TypeError("Reduce of empty array with no initial value")}return F}}if("function"!==typeof Array.prototype.filter){Array.prototype.filter=function(F){if(this===void 0||this===null){throw new TypeError()}var I=Object(this);var D=I.length>>>0;if(typeof F!=="function"){throw new TypeError()}var H=[];var E=arguments.length>=2?arguments[1]:void 0;for(var G=0;G<D;G++){if(G in I){var J=I[G];if(F.call(E,J,G,I)){H.push(J)}}}return H}}var f=typeof define==="function"&&define.amd;var p=function(F){var H=F==="Comic Sans MS"?"Courier New":"Comic Sans MS";var D=g("<div>").css({position:"absolute",left:"-9999px",top:"-9999px",fontSize:"200px"}).text("mmmmmmmmmwwwwwww").appendTo(document.body);var G=D.css("fontFamily",H).width();var E=D.css("fontFamily",F+","+H).width();D.remove();return G!==E};var b={isMac:navigator.appVersion.indexOf("Mac")>-1,isMSIE:navigator.userAgent.indexOf("MSIE")>-1||navigator.userAgent.indexOf("Trident")>-1,isFF:navigator.userAgent.indexOf("Firefox")>-1,jqueryVersion:parseFloat(g.fn.jquery),isSupportAmd:f,hasCodeMirror:f?require.specified("CodeMirror"):!!window.CodeMirror,isFontInstalled:p,isW3CRangeSupport:!!document.createRange};var j=(function(){var O=function(P){return function(Q){return P===Q}};var K=function(Q,P){return Q===P};var F=function(P){return function(R,Q){return R[P]===Q[P]}};var M=function(){return true};var H=function(){return false};var G=function(P){return function(){return !P.apply(P,arguments)}};var J=function(Q,P){return function(R){return Q(R)&&P(R)}};var N=function(P){return P};var E=0;var L=function(P){var Q=++E+"";return P?P+Q:Q};var D=function(P){var Q=g(document);return{top:P.top+Q.scrollTop(),left:P.left+Q.scrollLeft(),width:P.right-P.left,height:P.bottom-P.top}};var I=function(R){var P={};for(var Q in R){if(R.hasOwnProperty(Q)){P[R[Q]]=Q}}return P};return{eq:O,eq2:K,peq2:F,ok:M,fail:H,self:N,not:G,and:J,uniqueId:L,rect2bnd:D,invertObject:I}})();var z=(function(){var N=function(R){return R[0]};var Q=function(R){return R[R.length-1]};var K=function(R){return R.slice(0,R.length-1)};var L=function(R){return R.slice(1)};var J=function(V,T){for(var S=0,R=V.length;S<R;S++){var U=V[S];if(T(U)){return U}}};var P=function(U,T){for(var S=0,R=U.length;S<R;S++){if(!T(U[S])){return false}}return true};var E=function(S,R){return g.inArray(R,S)!==-1};var I=function(S,R){R=R||j.self;return S.reduce(function(U,T){return U+R(T)},0)};var O=function(U){var S=[],R=-1,T=U.length;while(++R<T){S[R]=U[R]}return S};var G=function(T,R){if(!T.length){return[]}var S=L(T);return S.reduce(function(W,V){var U=Q(W);if(R(Q(U),V)){U[U.length]=V}else{W[W.length]=[V]}return W},[[N(T)]])};var M=function(U){var T=[];for(var S=0,R=U.length;S<R;S++){if(U[S]){T.push(U[S])}}return T};var F=function(U){var T=[];for(var S=0,R=U.length;S<R;S++){if(!E(T,U[S])){T.push(U[S])}}return T};var H=function(T,S){var R=T.indexOf(S);if(R===-1){return null}return T[R+1]};var D=function(T,S){var R=T.indexOf(S);if(R===-1){return null}return T[R-1]};return{head:N,last:Q,initial:K,tail:L,prev:D,next:H,find:J,contains:E,all:P,sum:I,from:O,clusterBy:G,compact:M,unique:F}})();var o=String.fromCharCode(160);var u="\ufeff";var w=(function(){var H=function(aK){return aK&&g(aK).hasClass("note-editable")};var aj=function(aK){return aK&&g(aK).hasClass("note-control-sizing")};var aI=function(aK){var aL;if(aK.hasClass("note-air-editor")){var aM=z.last(aK.attr("id").split("-"));aL=function(aN){return function(){return g(aN+aM)}};return{editor:function(){return aK},editable:function(){return aK},popover:aL("#note-popover-"),handle:aL("#note-handle-"),dialog:aL("#note-dialog-")}}else{aL=function(aN){return function(){return aK.find(aN)}};return{editor:function(){return aK},dropzone:aL(".note-dropzone"),toolbar:aL(".note-toolbar"),editable:aL(".note-editable"),codable:aL(".note-codable"),statusbar:aL(".note-statusbar"),popover:aL(".note-popover"),handle:aL(".note-handle"),dialog:aL(".note-dialog")}}};var aE=function(aK){aK=aK.toUpperCase();return function(aL){return aL&&aL.nodeName.toUpperCase()===aK}};var M=function(aK){return aK&&aK.nodeType===3};var az=function(aK){return aK&&/^BR|^IMG|^HR/.test(aK.nodeName.toUpperCase())};var J=function(aK){if(H(aK)){return false}return aK&&/^DIV|^P|^LI|^H[1-7]/.test(aK.nodeName.toUpperCase())};var aC=aE("LI");var aG=function(aK){return J(aK)&&!aC(aK)};var U=function(aK){return !D(aK)&&!E(aK)&&!J(aK)};var E=function(aK){return aK&&/^UL|^OL/.test(aK.nodeName.toUpperCase())};var N=function(aK){return aK&&/^TD|^TH/.test(aK.nodeName.toUpperCase())};var aJ=aE("BLOCKQUOTE");var D=function(aK){return N(aK)||aJ(aK)||H(aK)};var L=aE("A");var an=function(aK){return U(aK)&&!!am(aK,J)};var ao=function(aK){return U(aK)&&!am(aK,J)};var G=aE("BODY");var ax=b.isMSIE?"&nbsp;":"<br>";var I=function(aK){if(M(aK)){return aK.nodeValue.length}return aK.childNodes.length};var W=function(aL){var aK=I(aL);if(aK===0){return true}else{if(!w.isText(aL)&&aK===1&&aL.innerHTML===ax){return true}}return false};var P=function(aK){if(!az(aK)&&!I(aK)){aK.innerHTML=ax}};var am=function(aL,aK){while(aL){if(aK(aL)){return aL}if(H(aL)){break}aL=aL.parentNode}return null};var ah=function(aM,aK){aK=aK||j.fail;var aL=[];am(aM,function(aN){if(!H(aN)){aL.push(aN)}return aK(aN)});return aL};var F=function(aM,aK){var aL=ah(aM);return z.last(aL.filter(aK))};var Y=function(aM,aL){var aK=ah(aM);for(var aN=aL;aN;aN=aN.parentNode){if(g.inArray(aN,aK)>-1){return aN}}return null};var au=function(aM,aL){aL=aL||j.fail;var aK=[];while(aM){if(aL(aM)){break}aK.push(aM);aM=aM.previousSibling}return aK};var T=function(aM,aL){aL=aL||j.fail;var aK=[];while(aM){if(aL(aM)){break}aK.push(aM);aM=aM.nextSibling}return aK};var K=function(aL,aK){var aN=[];aK=aK||j.ok;(function aM(aQ){if(aL!==aQ&&aK(aQ)){aN.push(aQ)}for(var aP=0,aO=aQ.childNodes.length;aP<aO;aP++){aM(aQ.childNodes[aP])}})(aL);return aN};var aw=function(aM,aL){var aK=aM.parentNode;var aN=g("<"+aL+">")[0];aK.insertBefore(aN,aM);aN.appendChild(aM);return aN};var S=function(aN,aM){var aL=aM.nextSibling,aK=aM.parentNode;if(aL){aK.insertBefore(aN,aL)}else{aK.appendChild(aN)}return aN};var aF=function(aK,aL){g.each(aL,function(aM,aN){aK.appendChild(aN)});return aK};var Z=function(aK){return aK.offset===0};var ak=function(aK){return aK.offset===I(aK.node)};var aq=function(aK){return Z(aK)||ak(aK)};var ay=function(aL,aK){while(aL&&aL!==aK){if(at(aL)!==0){return false}aL=aL.parentNode}return true};var ab=function(aL,aK){while(aL&&aL!==aK){if(at(aL)!==I(aL.parentNode)-1){return false}aL=aL.parentNode}return true};var at=function(aK){var aL=0;while((aK=aK.previousSibling)){aL+=1}return aL};var aa=function(aK){return !!(aK&&aK.childNodes&&aK.childNodes.length)};var Q=function(aK,aL){var aM,aN;if(aK.offset===0){if(H(aK.node)){return null}aM=aK.node.parentNode;aN=at(aK.node)}else{if(aa(aK.node)){aM=aK.node.childNodes[aK.offset-1];aN=I(aM)}else{aM=aK.node;aN=aL?0:aK.offset-1}}return{node:aM,offset:aN}};var V=function(aK,aL){var aM,aN;if(I(aK.node)===aK.offset){if(H(aK.node)){return null}aM=aK.node.parentNode;aN=at(aK.node)+1}else{if(aa(aK.node)){aM=aK.node.childNodes[aK.offset];aN=0}else{aM=aK.node;aN=aL?I(aK.node):aK.offset+1}}return{node:aM,offset:aN}};var ae=function(aK,aL){return aK.node===aL.node&&aK.offset===aL.offset};var ad=function(aK){if(M(aK.node)||!aa(aK.node)||W(aK.node)){return true}var aM=aK.node.childNodes[aK.offset-1];var aL=aK.node.childNodes[aK.offset];if((!aM||az(aM))&&(!aL||az(aL))){return true}return false};var aA=function(aK,aL){while(aK){if(aL(aK)){return aK}aK=Q(aK)}return null};var al=function(aK,aL){while(aK){if(aL(aK)){return aK}aK=V(aK)}return null};var O=function(aP,aM,aN,aL){var aK=aP;while(aK){aN(aK);if(ae(aK,aM)){break}var aO=aL&&aP.node!==aK.node&&aM.node!==aK.node;aK=V(aK,aO)}};var X=function(aK,aM){var aL=ah(aM,j.eq(aK));return g.map(aL,at).reverse()};var aB=function(aM,aN){var aO=aM;for(var aL=0,aK=aN.length;aL<aK;aL++){if(aO.childNodes.length<=aN[aL]){aO=aO.childNodes[aO.childNodes.length-1]}else{aO=aO.childNodes[aN[aL]]}}return aO};var aH=function(aK,aM){if(M(aK.node)){if(Z(aK)){return aK.node}else{if(ak(aK)){return aK.node.nextSibling}}return aK.node.splitText(aK.offset)}var aL=aK.node.childNodes[aK.offset];var aN=S(aK.node.cloneNode(false),aK.node);aF(aN,T(aL));if(!aM){P(aK.node);P(aN)}return aN};var ar=function(aL,aK,aN){var aM=ah(aK.node,j.eq(aL));if(!aM.length){return null}else{if(aM.length===1){return aH(aK,aN)}}return aM.reduce(function(aP,aO){var aQ=S(aO.cloneNode(false),aO);if(aP===aK.node){aP=aH(aK,aN)}aF(aQ,T(aP));if(!aN){P(aO);P(aQ)}return aQ})};var R=function(aK){return document.createElement(aK)};var aD=function(aK){return document.createTextNode(aK)};var ag=function(aO,aP){if(!aO||!aO.parentNode){return}if(aO.removeNode){return aO.removeNode(aP)}var aN=aO.parentNode;if(!aP){var aL=[];var aM,aK;for(aM=0,aK=aO.childNodes.length;aM<aK;aM++){aL.push(aO.childNodes[aM])}for(aM=0,aK=aL.length;aM<aK;aM++){aN.insertBefore(aL[aM],aO)}}aN.removeChild(aO)};var ap=function(aM,aK){while(aM){if(H(aM)||!aK(aM)){break}var aL=aM.parentNode;ag(aM);aM=aL}};var af=function(aL,aM){if(aL.nodeName.toUpperCase()===aM.toUpperCase()){return aL}var aK=R(aM);if(aL.style.cssText){aK.style.cssText=aL.style.cssText}aF(aK,z.from(aL.childNodes));S(aK,aL);ag(aL);return aK};var ac=aE("TEXTAREA");var ai=function(aL,aM){var aK=ac(aL[0])?aL.val():aL.html();if(aM){var aN=/<(\/?)(\b(?!!)[^>\s]*)(.*?)(\s*\/?>)/g;aK=aK.replace(aN,function(aP,aS,aO){aO=aO.toUpperCase();var aR=/^DIV|^TD|^TH|^P|^LI|^H[1-7]/.test(aO)&&!!aS;var aQ=/^BLOCKQUOTE|^TABLE|^TBODY|^TR|^HR|^UL|^OL/.test(aO);return aP+((aR||aQ)?"\n":"")});aK=g.trim(aK)}return aK};var av=function(aL){var aK=aL.val();return aK.replace(/[\n\r]/g,"")};return{NBSP_CHAR:o,ZERO_WIDTH_NBSP_CHAR:u,blank:ax,emptyPara:"<p>"+ax+"</p>",isEditable:H,isControlSizing:aj,buildLayoutInfo:aI,isText:M,isPara:J,isPurePara:aG,isInline:U,isBodyInline:ao,isBody:G,isParaInline:an,isList:E,isTable:aE("TABLE"),isCell:N,isBlockquote:aJ,isBodyContainer:D,isAnchor:L,isDiv:aE("DIV"),isLi:aC,isSpan:aE("SPAN"),isB:aE("B"),isU:aE("U"),isS:aE("S"),isI:aE("I"),isImg:aE("IMG"),isTextarea:ac,isEmpty:W,isEmptyAnchor:j.and(L,W),nodeLength:I,isLeftEdgePoint:Z,isRightEdgePoint:ak,isEdgePoint:aq,isLeftEdgeOf:ay,isRightEdgeOf:ab,prevPoint:Q,nextPoint:V,isSamePoint:ae,isVisiblePoint:ad,prevPointUntil:aA,nextPointUntil:al,walkPoint:O,ancestor:am,listAncestor:ah,lastAncestor:F,listNext:T,listPrev:au,listDescendant:K,commonAncestor:Y,wrap:aw,insertAfter:S,appendChildNodes:aF,position:at,hasChildren:aa,makeOffsetPath:X,fromOffsetPath:aB,splitTree:ar,create:R,createText:aD,remove:ag,removeWhile:ap,replace:af,html:ai,value:av}})();var A={version:"0.5.10",options:{width:null,height:null,minHeight:null,maxHeight:null,focus:false,tabsize:4,styleWithSpan:true,disableLinkTarget:false,disableDragAndDrop:false,disableResizeEditor:false,codemirror:{mode:"text/html",htmlMode:true,lineNumbers:true},lang:"en-US",direction:null,toolbar:[["style",["style"]],["font",["bold","italic","underline","superscript","subscript","strikethrough","clear"]],["fontname",["fontname"]],["color",["color"]],["para",["ul","ol","paragraph"]],["height",["height"]],["table",["table"]],["insert",["link","picture","video","hr"]],["view",["fullscreen","codeview"]],["help",["help"]]],airMode:false,airPopover:[["color",["color"]],["font",["bold","underline","clear"]],["para",["ul","paragraph"]],["table",["table"]],["insert",["link","picture"]]],styleTags:["p","blockquote","pre","h1","h2","h3","h4","h5","h6"],defaultFontName:"Helvetica Neue",fontNames:["Arial","Arial Black","Comic Sans MS","Courier New","Helvetica Neue","Impact","Lucida Grande","Tahoma","Times New Roman","Verdana"],colors:[["#000000","#424242","#636363","#9C9C94","#CEC6CE","#EFEFEF","#F7F7F7","#FFFFFF"],["#FF0000","#FF9C00","#FFFF00","#00FF00","#00FFFF","#0000FF","#9C00FF","#FF00FF"],["#F7C6CE","#FFE7CE","#FFEFC6","#D6EFD6","#CEDEE7","#CEE7F7","#D6D6E7","#E7D6DE"],["#E79C9C","#FFC69C","#FFE79C","#B5D6A5","#A5C6CE","#9CC6EF","#B5A5D6","#D6A5BD"],["#E76363","#F7AD6B","#FFD663","#94BD7B","#73A5AD","#6BADDE","#8C7BC6","#C67BA5"],["#CE0000","#E79439","#EFC631","#6BA54A","#4A7B8C","#3984C6","#634AA5","#A54A7B"],["#9C0000","#B56308","#BD9400","#397B21","#104A5A","#085294","#311873","#731842"],["#630000","#7B3900","#846300","#295218","#083139","#003163","#21104A","#4A1031"]],fontSizes:["8","9","10","11","12","14","18","24","36"],lineHeights:["1.0","1.2","1.4","1.5","1.6","1.8","2.0","3.0"],insertTableMaxSize:{col:10,row:10},oninit:null,onfocus:null,onblur:null,onenter:null,onkeyup:null,onkeydown:null,onImageUpload:null,onImageUploadError:null,onToolbarClick:null,onCreateLink:function(D){if(D.indexOf("@")!==-1&&D.indexOf(":")===-1){D="mailto:"+D}else{if(D.indexOf("://")===-1){D="http://"+D}}return D},keyMap:{pc:{ENTER:"insertParagraph","CTRL+Z":"undo","CTRL+Y":"redo",TAB:"tab","SHIFT+TAB":"untab","CTRL+B":"bold","CTRL+I":"italic","CTRL+U":"underline","CTRL+SHIFT+S":"strikethrough","CTRL+BACKSLASH":"removeFormat","CTRL+SHIFT+L":"justifyLeft","CTRL+SHIFT+E":"justifyCenter","CTRL+SHIFT+R":"justifyRight","CTRL+SHIFT+J":"justifyFull","CTRL+SHIFT+NUM7":"insertUnorderedList","CTRL+SHIFT+NUM8":"insertOrderedList","CTRL+LEFTBRACKET":"outdent","CTRL+RIGHTBRACKET":"indent","CTRL+NUM0":"formatPara","CTRL+NUM1":"formatH1","CTRL+NUM2":"formatH2","CTRL+NUM3":"formatH3","CTRL+NUM4":"formatH4","CTRL+NUM5":"formatH5","CTRL+NUM6":"formatH6","CTRL+ENTER":"insertHorizontalRule","CTRL+K":"showLinkDialog"},mac:{ENTER:"insertParagraph","CMD+Z":"undo","CMD+SHIFT+Z":"redo",TAB:"tab","SHIFT+TAB":"untab","CMD+B":"bold","CMD+I":"italic","CMD+U":"underline","CMD+SHIFT+S":"strikethrough","CMD+BACKSLASH":"removeFormat","CMD+SHIFT+L":"justifyLeft","CMD+SHIFT+E":"justifyCenter","CMD+SHIFT+R":"justifyRight","CMD+SHIFT+J":"justifyFull","CMD+SHIFT+NUM7":"insertUnorderedList","CMD+SHIFT+NUM8":"insertOrderedList","CMD+LEFTBRACKET":"outdent","CMD+RIGHTBRACKET":"indent","CMD+NUM0":"formatPara","CMD+NUM1":"formatH1","CMD+NUM2":"formatH2","CMD+NUM3":"formatH3","CMD+NUM4":"formatH4","CMD+NUM5":"formatH5","CMD+NUM6":"formatH6","CMD+ENTER":"insertHorizontalRule","CMD+K":"showLinkDialog"}}},lang:{"en-US":{font:{bold:"Bold",italic:"Italic",underline:"Underline",strikethrough:"Strikethrough",subscript:"Subscript",superscript:"Superscript",clear:"Remove Font Style",height:"Line Height",name:"Font Family",size:"Font Size"},image:{image:"Picture",insert:"Insert Image",resizeFull:"Resize Full",resizeHalf:"Resize Half",resizeQuarter:"Resize Quarter",floatLeft:"Float Left",floatRight:"Float Right",floatNone:"Float None",shapeRounded:"Shape: Rounded",shapeCircle:"Shape: Circle",shapeThumbnail:"Shape: Thumbnail",shapeNone:"Shape: None",dragImageHere:"Drag an image here",selectFromFiles:"Select from files",url:"Image URL",remove:"Remove Image"},link:{link:"Link",insert:"Insert Link",unlink:"Unlink",edit:"Edit",textToDisplay:"Text to display",url:"To what URL should this link go?",openInNewWindow:"Open in new window"},video:{video:"Video",videoLink:"Video Link",insert:"Insert Video",url:"Video URL?",providers:"(YouTube, Vimeo, Vine, Instagram, DailyMotion or Youku)"},table:{table:"Table"},hr:{insert:"Insert Horizontal Rule"},style:{style:"Style",normal:"Normal",blockquote:"Quote",pre:"Code",h1:"Header 1",h2:"Header 2",h3:"Header 3",h4:"Header 4",h5:"Header 5",h6:"Header 6"},lists:{unordered:"Unordered list",ordered:"Ordered list"},options:{help:"Help",fullscreen:"Full Screen",codeview:"Code View"},paragraph:{paragraph:"Paragraph",outdent:"Outdent",indent:"Indent",left:"Align left",center:"Align center",right:"Align right",justify:"Justify full"},color:{recent:"Recent Color",more:"More Color",background:"Background Color",foreground:"Foreground Color",transparent:"Transparent",setTransparent:"Set transparent",reset:"Reset",resetToDefault:"Reset to default"},shortcut:{shortcuts:"Keyboard shortcuts",close:"Close",textFormatting:"Text formatting",action:"Action",paragraphFormatting:"Paragraph formatting",documentStyle:"Document Style"},history:{undo:"Undo",redo:"Redo"}}}};var i=(function(){var D=function(F){return g.Deferred(function(G){g.extend(new FileReader(),{onload:function(I){var H=I.target.result;G.resolve(H)},onerror:function(){G.reject(this)}}).readAsDataURL(F)}).promise()};var E=function(G,F){return g.Deferred(function(H){g("<img>").one("load",function(){H.resolve(g(this))}).one("error abort",function(){H.reject(g(this))}).css({display:"none"}).appendTo(document.body).attr("src",G).attr("data-filename",F)}).promise()};return{readFileAsDataURL:D,createImage:E}})();var C={isEdit:function(D){return z.contains([8,9,13,32],D)},nameFromCode:{"8":"BACKSPACE","9":"TAB","13":"ENTER","32":"SPACE","48":"NUM0","49":"NUM1","50":"NUM2","51":"NUM3","52":"NUM4","53":"NUM5","54":"NUM6","55":"NUM7","56":"NUM8","66":"B","69":"E","73":"I","74":"J","75":"K","76":"L","82":"R","83":"S","85":"U","89":"Y","90":"Z","191":"SLASH","219":"LEFTBRACKET","220":"BACKSLASH","221":"RIGHTBRACKET"}};var a=function(){var D=function(G,F){if(b.jqueryVersion<1.9){var E={};g.each(F,function(H,I){E[I]=G.css(I)});return E}return G.css.call(G,F)};this.stylePara=function(E,F){g.each(E.nodes(w.isPara,{includeAncestor:true}),function(H,G){g(G).css(F)})};this.current=function(E,I){var L=g(w.isText(E.sc)?E.sc.parentNode:E.sc);var J=["font-family","font-size","text-align","list-style-type","line-height"];var H=D(L,J)||{};H["font-size"]=parseInt(H["font-size"],10);H["font-bold"]=document.queryCommandState("bold")?"bold":"normal";H["font-italic"]=document.queryCommandState("italic")?"italic":"normal";H["font-underline"]=document.queryCommandState("underline")?"underline":"normal";H["font-strikethrough"]=document.queryCommandState("strikeThrough")?"strikethrough":"normal";H["font-superscript"]=document.queryCommandState("superscript")?"superscript":"normal";H["font-subscript"]=document.queryCommandState("subscript")?"subscript":"normal";if(!E.isOnList()){H["list-style"]="none"}else{var G=["circle","disc","disc-leading-zero","square"];var F=g.inArray(H["list-style-type"],G)>-1;H["list-style"]=F?"unordered":"ordered"}var M=w.ancestor(E.sc,w.isPara);if(M&&M.style["line-height"]){H["line-height"]=M.style.lineHeight}else{var K=parseInt(H["line-height"],10)/parseInt(H["font-size"],10);H["line-height"]=K.toFixed(1)}H.image=w.isImg(I)&&I;H.anchor=E.isOnAnchor()&&w.ancestor(E.sc,w.isAnchor);H.ancestors=w.listAncestor(E.sc,w.isEditable);H.range=E;return H}};var n=(function(){var F=function(Q,G){var J=Q.parentElement(),L;var P=document.body.createTextRange(),N;var O=z.from(J.childNodes);for(L=0;L<O.length;L++){if(w.isText(O[L])){continue}P.moveToElementText(O[L]);if(P.compareEndPoints("StartToStart",Q)>=0){break}N=O[L]}if(L!==0&&w.isText(O[L-1])){var R=document.body.createTextRange(),M=null;R.moveToElementText(N||J);R.collapse(!N);M=N?N.nextSibling:J.firstChild;var I=Q.duplicate();I.setEndPoint("StartToStart",R);var H=I.text.replace(/[\r\n]/g,"").length;while(H>M.nodeValue.length&&M.nextSibling){H-=M.nodeValue.length;M=M.nextSibling}var K=M.nodeValue;if(G&&M.nextSibling&&w.isText(M.nextSibling)&&H===M.nodeValue.length){H-=M.nodeValue.length;M=M.nextSibling}J=M;L=H}return{cont:J,offset:L}};var D=function(G){var J=function(M,P){var O,L;if(w.isText(M)){var K=w.listPrev(M,j.not(w.isText));var N=z.last(K).previousSibling;O=N||M.parentNode;P+=z.sum(z.tail(K),w.nodeLength);L=!N}else{O=M.childNodes[P]||M;if(w.isText(O)){return J(O,0)}P=0;L=false}return{node:O,collapseToStart:L,offset:P}};var H=document.body.createTextRange();var I=J(G.node,G.offset);H.moveToElementText(I.node);H.collapse(I.collapseToStart);H.moveStart("character",I.offset);return H};var E=function(L,K,H,G){this.sc=L;this.so=K;this.ec=H;this.eo=G;var J=function(){if(b.isW3CRangeSupport){var M=document.createRange();M.setStart(L,K);M.setEnd(H,G);return M}else{var N=D({node:L,offset:K});N.setEndPoint("EndToEnd",D({node:H,offset:G}));return N}};this.getPoints=function(){return{sc:L,so:K,ec:H,eo:G}};this.getStartPoint=function(){return{node:L,offset:K}};this.getEndPoint=function(){return{node:H,offset:G}};this.select=function(){var N=J();if(b.isW3CRangeSupport){var M=document.getSelection();if(M.rangeCount>0){M.removeAllRanges()}M.addRange(N)}else{N.select()}};this.normalize=function(){var O=function(P){if(!w.isVisiblePoint(P)){if(w.isLeftEdgePoint(P)){P=w.nextPointUntil(P,w.isVisiblePoint)}else{if(w.isRightEdgePoint(P)){P=w.prevPointUntil(P,w.isVisiblePoint)}}}return P};var N=O(this.getStartPoint());var M=O(this.getStartPoint());return new E(N.node,N.offset,M.node,M.offset)};this.nodes=function(O,P){O=O||j.ok;var M=P&&P.includeAncestor;var T=P&&P.fullyContains;var R=this.getStartPoint();var Q=this.getEndPoint();var N=[];var S=[];w.walkPoint(R,Q,function(U){if(w.isEditable(U.node)){return}var V;if(T){if(w.isLeftEdgePoint(U)){S.push(U.node)}if(w.isRightEdgePoint(U)&&z.contains(S,U.node)){V=U.node}}else{if(M){V=w.ancestor(U.node,O)}else{V=U.node}}if(V&&O(V)){N.push(V)}},true);return z.unique(N)};this.commonAncestor=function(){return w.commonAncestor(L,H)};this.expand=function(M){var O=w.ancestor(L,M);var P=w.ancestor(H,M);if(!O&&!P){return new E(L,K,H,G)}var N=this.getPoints();if(O){N.sc=O;N.so=0}if(P){N.ec=P;N.eo=w.nodeLength(P)}return new E(N.sc,N.so,N.ec,N.eo)};this.collapse=function(M){if(M){return new E(L,K,L,K)}else{return new E(H,G,H,G)}};this.splitText=function(){var M=L===H;var N=this.getPoints();if(w.isText(H)&&!w.isEdgePoint(this.getEndPoint())){H.splitText(G)}if(w.isText(L)&&!w.isEdgePoint(this.getStartPoint())){N.sc=L.splitText(K);N.so=0;if(M){N.ec=N.sc;N.eo=G-K}}return new E(N.sc,N.so,N.ec,N.eo)};this.deleteContents=function(){if(this.isCollapsed()){return this}var N=this.splitText();var O=N.nodes(null,{fullyContains:true});var M=w.prevPointUntil(N.getStartPoint(),function(Q){return !z.contains(O,Q.node)});var P=[];g.each(O,function(Q,S){var R=S.parentNode;if(M.node!==R&&w.nodeLength(R)===1){P.push(R)}w.remove(S,false)});g.each(P,function(Q,R){w.remove(R,false)});return new E(M.node,M.offset,M.node,M.offset)};var I=function(M){return function(){var N=w.ancestor(L,M);return !!N&&(N===w.ancestor(H,M))}};this.isOnEditable=I(w.isEditable);this.isOnList=I(w.isList);this.isOnAnchor=I(w.isAnchor);this.isOnCell=I(w.isCell);this.isLeftEdgeOf=function(M){if(!w.isLeftEdgePoint(this.getStartPoint())){return false}var N=w.ancestor(this.sc,M);return N&&w.isLeftEdgeOf(this.sc,N)};this.isCollapsed=function(){return L===H&&K===G};this.wrapBodyInlineWithPara=function(){if(w.isBodyContainer(L)&&w.isEmpty(L)){L.innerHTML=w.emptyPara;return new E(L.firstChild,0)}else{if(!w.isInline(L)||w.isParaInline(L)){return this}}var N=w.listAncestor(L,j.not(w.isInline));var P=z.last(N);if(!w.isInline(P)){P=N[N.length-2]||L.childNodes[K]}var O=w.listPrev(P,w.isParaInline).reverse();O=O.concat(w.listNext(P.nextSibling,w.isParaInline));if(O.length){var M=w.wrap(z.head(O),"p");w.appendChildNodes(M,z.tail(O))}return this};this.insertNode=function(P,Q){var N=this.wrapBodyInlineWithPara();var S=N.getStartPoint();var R,O,T;if(Q){O=w.isPara(S.node)?S.node:S.node.parentNode;if(w.isPara(S.node)){T=S.node.childNodes[S.offset]}else{T=w.splitTree(S.node,S)}}else{var U=w.listAncestor(S.node,w.isBodyContainer);var M=z.last(U)||S.node;if(w.isBodyContainer(M)){R=U[U.length-2];O=M}else{R=M;O=R.parentNode}T=R&&w.splitTree(R,S)}if(T){T.parentNode.insertBefore(P,T)}else{O.appendChild(P)}return P};this.toString=function(){var M=J();return b.isW3CRangeSupport?M.toString():M.text};this.bookmark=function(M){return{s:{path:w.makeOffsetPath(M,L),offset:K},e:{path:w.makeOffsetPath(M,H),offset:G}}};this.getClientRects=function(){var M=J();return M.getClientRects()}};return{create:function(L,I,K,G){if(!arguments.length){if(b.isW3CRangeSupport){var O=document.getSelection();if(O.rangeCount===0){return null}else{if(w.isBody(O.anchorNode)){return null}}var N=O.getRangeAt(0);L=N.startContainer;I=N.startOffset;K=N.endContainer;G=N.endOffset}else{var Q=document.selection.createRange();var J=Q.duplicate();J.collapse(false);var P=Q;P.collapse(true);var H=F(P,true),M=F(J,false);if(w.isText(H.node)&&w.isLeftEdgePoint(H)&&w.isTextNode(M.node)&&w.isRightEdgePoint(M)&&M.node.nextSibling===H.node){H=M}L=H.cont;I=H.offset;K=M.cont;G=M.offset}}else{if(arguments.length===2){K=L;G=I}}return new E(L,I,K,G)},createFromNode:function(G){return this.create(G,0,G,1)},createFromBookmark:function(I,J){var L=w.fromOffsetPath(I,J.s.path);var K=J.s.offset;var H=w.fromOffsetPath(I,J.e.path);var G=J.e.offset;return new E(L,K,H,G)}}})();var B=function(){this.insertTab=function(F,E,D){var G=w.createText(new Array(D+1).join(w.NBSP_CHAR));E=E.deleteContents();E.insertNode(G,true);E=n.create(G,D);E.select()};this.insertParagraph=function(){var E=n.create();E=E.deleteContents();E=E.wrapBodyInlineWithPara();var H=w.ancestor(E.sc,w.isPara);var G;if(H){G=w.splitTree(H,E.getStartPoint());var D=w.listDescendant(H,w.isEmptyAnchor);D=D.concat(w.listDescendant(G,w.isEmptyAnchor));g.each(D,function(I,J){w.remove(J)})}else{var F=E.sc.childNodes[E.so];G=g(w.emptyPara)[0];if(F){E.sc.insertBefore(G,F)}else{E.sc.appendChild(G)}}n.create(G,0).normalize().select()}};var e=function(){this.tab=function(E,G){var D=w.ancestor(E.commonAncestor(),w.isCell);var I=w.ancestor(D,w.isTable);var F=w.listDescendant(I,w.isCell);var H=z[G?"prev":"next"](F,D);if(H){n.create(H,0).select()}};this.createTable=function(I,F){var H=[],E;for(var G=0;G<I;G++){H.push("<td>"+w.blank+"</td>")}E=H.join("");var D=[],J;for(var K=0;K<F;K++){D.push("<tr>"+E+"</tr>")}J=D.join("");return g('<table class="table table-bordered">'+J+"</table>")[0]}};var k=function(){this.insertOrderedList=function(){this.toggleList("OL")};this.insertUnorderedList=function(){this.toggleList("UL")};this.indent=function(){var E=this;var D=n.create().wrapBodyInlineWithPara();var F=D.nodes(w.isPara,{includeAncestor:true});var G=z.clusterBy(F,j.peq2("parentNode"));g.each(G,function(H,I){var J=z.head(I);if(w.isLi(J)){E.wrapList(I,J.parentNode.nodeName)}else{g.each(I,function(L,K){g(K).css("marginLeft",function(M,N){return(parseInt(N,10)||0)+25})})}});D.select()};this.outdent=function(){var E=this;var D=n.create().wrapBodyInlineWithPara();var F=D.nodes(w.isPara,{includeAncestor:true});var G=z.clusterBy(F,j.peq2("parentNode"));g.each(G,function(H,I){var J=z.head(I);if(w.isLi(J)){E.releaseList([I])}else{g.each(I,function(L,K){g(K).css("marginLeft",function(M,N){N=(parseInt(N,10)||0);return N>25?N-25:""})})}});D.select()};this.toggleList=function(G){var E=this;var D=n.create().wrapBodyInlineWithPara();var F=D.nodes(w.isPara,{includeAncestor:true});var I=z.clusterBy(F,j.peq2("parentNode"));if(z.find(F,w.isPurePara)){g.each(I,function(J,K){E.wrapList(K,G)})}else{var H=D.nodes(w.isList,{includeAncestor:true}).filter(function(J){return !g.nodeName(J,G)});if(H.length){g.each(H,function(J,K){w.replace(K,G)})}else{this.releaseList(I,true)}}D.select()};this.wrapList=function(G,F){var H=z.head(G);var J=z.last(G);var E=w.isList(H.previousSibling)&&H.previousSibling;var D=w.isList(J.nextSibling)&&J.nextSibling;var I=E||w.insertAfter(w.create(F||"UL"),J);G=g.map(G,function(K){return w.isPurePara(K)?w.replace(K,"LI"):K});w.appendChildNodes(I,G);if(D){w.appendChildNodes(I,z.from(D.childNodes));w.remove(D)}};this.releaseList=function(F,D){var E=[];g.each(F,function(G,H){var I=z.head(H);var J=z.last(H);var M=D?w.lastAncestor(I,w.isList):I.parentNode;var L=M.childNodes.length>1?w.splitTree(M,{node:J.parentNode,offset:w.position(J)+1},true):null;var K=w.splitTree(M,{node:I.parentNode,offset:w.position(I)},true);H=D?w.listDescendant(K,w.isLi):z.from(K.childNodes).filter(w.isLi);if(D||!w.isList(M.parentNode)){H=g.map(H,function(O){return w.replace(O,"P")})}g.each(z.from(H).reverse(),function(P,O){w.insertAfter(O,M)});var N=z.compact([M,K,L]);g.each(N,function(O,P){var Q=[P].concat(w.listDescendant(P,w.isList));g.each(Q.reverse(),function(R,S){if(!w.nodeLength(S)){w.remove(S,true)}})});E=E.concat(H)});return E}};var r=function(){var E=new a();var K=new e();var J=new B();var D=new k();this.saveRange=function(M,N){M.focus();M.data("range",n.create());if(N){n.create().collapse().select()}};this.restoreRange=function(N){var M=N.data("range");if(M){M.select();N.focus()}};this.currentStyle=function(N){var M=n.create();return M?M.isOnEditable()&&E.current(M,N):false};var G=this.triggerOnChange=function(N){var M=N.data("callbacks").onChange;if(M){M(N.html(),N)}};this.undo=function(M){M.data("NoteHistory").undo();G(M)};this.redo=function(M){M.data("NoteHistory").redo();G(M)};var L=this.afterCommand=function(M){M.data("NoteHistory").recordUndo();G(M)};var F=["bold","italic","underline","strikethrough","superscript","subscript","justifyLeft","justifyCenter","justifyRight","justifyFull","formatBlock","removeFormat","backColor","foreColor","insertHorizontalRule","fontName"];for(var I=0,H=F.length;I<H;I++){this[F[I]]=(function(M){return function(N,O){document.execCommand(M,false,O);L(N)}})(F[I])}this.tab=function(N,O){var M=n.create();if(M.isCollapsed()&&M.isOnCell()){K.tab(M)}else{J.insertTab(N,M,O.tabsize);L(N)}};this.untab=function(){var M=n.create();if(M.isCollapsed()&&M.isOnCell()){K.tab(M,true)}};this.insertParagraph=function(M){J.insertParagraph(M);L(M)};this.insertOrderedList=function(M){D.insertOrderedList(M);L(M)};this.insertUnorderedList=function(M){D.insertUnorderedList(M);L(M)};this.indent=function(M){D.indent(M);L(M)};this.outdent=function(M){D.outdent(M);L(M)};this.insertImage=function(N,O,M){i.createImage(O,M).then(function(P){P.css({display:"",width:Math.min(N.width(),P.width())});n.create().insertNode(P[0]);L(N)}).fail(function(){var P=N.data("callbacks");if(P.onImageUploadError){P.onImageUploadError()}})};this.insertVideo=function(aa,Q){var P=/^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|\&v=)([^#\&\?]*).*/;var U=Q.match(P);var X=/\/\/instagram.com\/p\/(.[a-zA-Z0-9]*)/;var W=Q.match(X);var Y=/\/\/vine.co\/v\/(.[a-zA-Z0-9]*)/;var T=Q.match(Y);var R=/\/\/(player.)?vimeo.com\/([a-z]*\/)*([0-9]{6,11})[?]?.*/;var S=Q.match(R);var O=/.+dailymotion.com\/(video|hub)\/([^_]+)[^#]*(#video=([^_&]+))?/;var Z=Q.match(O);var V=/\/\/v\.youku\.com\/v_show\/id_(\w+)\.html/;var ab=Q.match(V);var N;if(U&&U[2].length===11){var M=U[2];N=g("<iframe>").attr("src","//www.youtube.com/embed/"+M).attr("width","640").attr("height","360")}else{if(W&&W[0].length){N=g("<iframe>").attr("src",W[0]+"/embed/").attr("width","612").attr("height","710").attr("scrolling","no").attr("allowtransparency","true")}else{if(T&&T[0].length){N=g("<iframe>").attr("src",T[0]+"/embed/simple").attr("width","600").attr("height","600").attr("class","vine-embed")}else{if(S&&S[3].length){N=g("<iframe webkitallowfullscreen mozallowfullscreen allowfullscreen>").attr("src","//player.vimeo.com/video/"+S[3]).attr("width","640").attr("height","360")}else{if(Z&&Z[2].length){N=g("<iframe>").attr("src","//www.dailymotion.com/embed/video/"+Z[2]).attr("width","640").attr("height","360")}else{if(ab&&ab[1].length){N=g("<iframe webkitallowfullscreen mozallowfullscreen allowfullscreen>").attr("height","498").attr("width","510").attr("src","//player.youku.com/embed/"+ab[1])}else{}}}}}}if(N){N.attr("frameborder",0);n.create().insertNode(N[0]);L(aa)}};this.formatBlock=function(M,N){N=b.isMSIE?"<"+N+">":N;document.execCommand("FormatBlock",false,N);L(M)};this.formatPara=function(M){this.formatBlock(M,"P");L(M)};for(var I=1;I<=6;I++){this["formatH"+I]=function(M){return function(N){this.formatBlock(N,"H"+M)}}(I)}this.fontSize=function(M,N){document.execCommand("fontSize",false,3);if(b.isFF){M.find("font[size=3]").removeAttr("size").css("font-size",N+"px")}else{M.find("span").filter(function(){return this.style.fontSize==="medium"}).css("font-size",N+"px")}L(M)};this.lineHeight=function(M,N){E.stylePara(n.create(),{lineHeight:N});L(M)};this.unlink=function(N){var M=n.create();if(M.isOnAnchor()){var O=w.ancestor(M.sc,w.isAnchor);M=n.createFromNode(O);M.select();document.execCommand("unlink");L(N)}};this.createLink=function(P,S,R){var O=S.url;var T=S.text;var M=S.newWindow;var N=S.range;if(R.onCreateLink){O=R.onCreateLink(O)}N=N.deleteContents();var Q=N.insertNode(g("<A>"+T+"</A>")[0],true);g(Q).attr({href:O,target:M?"_blank":""});n.createFromNode(Q).select();L(P)};this.getLinkInfo=function(N){N.focus();var M=n.create().expand(w.isAnchor);var O=g(z.head(M.nodes(w.isAnchor)));return{range:M,text:M.toString(),isNewWindow:O.length?O.attr("target")==="_blank":true,url:O.length?O.attr("href"):""}};this.getVideoInfo=function(N){N.focus();var M=n.create();if(M.isOnAnchor()){var O=w.ancestor(M.sc,w.isAnchor);M=n.createFromNode(O)}return{text:M.toString()}};this.color=function(N,O){var Q=JSON.parse(O);var P=Q.foreColor,M=Q.backColor;if(P){document.execCommand("foreColor",false,P)}if(M){document.execCommand("backColor",false,M)}L(N)};this.insertTable=function(O,M){var P=M.split("x");var N=n.create();N=N.deleteContents();N.insertNode(K.createTable(P[0],P[1]));L(O)};this.floatMe=function(N,O,M){M.css("float",O);L(N)};this.imageShape=function(N,O,M){M.removeClass("img-rounded img-circle img-thumbnail");if(O){M.addClass(O)}L(N)};this.resize=function(N,O,M){M.css({width:O*100+"%",height:""});L(N)};this.resizeTo=function(R,M,N){var Q;if(N){var P=R.y/R.x;var O=M.data("ratio");Q={width:O>P?R.x:R.y/O,height:O>P?R.x*O:R.y}}else{Q={width:R.x,height:R.y}}M.css(Q)};this.removeMedia=function(N,O,M){M.detach();L(N)};this.insertDom=function(M,N){n.create().insertNode(N);L(M)}};var d=function(G){var E=[],F=-1;var H=G[0];var D=function(){var J=n.create();var K={s:{path:[0],offset:0},e:{path:[0],offset:0}};return{contents:G.html(),bookmark:(J?J.bookmark(H):K)}};var I=function(J){if(J.contents!==null){G.html(J.contents)}if(J.bookmark!==null){n.createFromBookmark(H,J.bookmark).select()}};this.undo=function(){if(0<F){F--;I(E[F])}};this.redo=function(){if(E.length-1>F){F++;I(E[F])}};this.recordUndo=function(){F++;if(E.length>F){E=E.slice(0,F)}E.push(D())};this.recordUndo()};var m=function(){this.update=function(K,J){var I=function(L,M){L.find(".dropdown-menu li a").each(function(){var N=(g(this).data("value")+"")===(M+"");this.className=N?"checked":""})};var H=function(L,M){var N=K.find(L);N.toggleClass("active",M())};var F=K.find(".note-fontname");if(F.length){var D=J["font-family"];if(!!D){D=z.head(D.split(","));D=D.replace(/\'/g,"");F.find(".note-current-fontname").text(D);I(F,D)}}var G=K.find(".note-fontsize");G.find(".note-current-fontsize").text(J["font-size"]);I(G,parseFloat(J["font-size"]));var E=K.find(".note-height");I(E,parseFloat(J["line-height"]));H('button[data-event="bold"]',function(){return J["font-bold"]==="bold"});H('button[data-event="italic"]',function(){return J["font-italic"]==="italic"});H('button[data-event="underline"]',function(){return J["font-underline"]==="underline"});H('button[data-event="strikethrough"]',function(){return J["font-strikethrough"]==="strikethrough"});H('button[data-event="superscript"]',function(){return J["font-superscript"]==="superscript"});H('button[data-event="subscript"]',function(){return J["font-subscript"]==="subscript"});H('button[data-event="justifyLeft"]',function(){return J["text-align"]==="left"||J["text-align"]==="start"});H('button[data-event="justifyCenter"]',function(){return J["text-align"]==="center"});H('button[data-event="justifyRight"]',function(){return J["text-align"]==="right"});H('button[data-event="justifyFull"]',function(){return J["text-align"]==="justify"});H('button[data-event="insertUnorderedList"]',function(){return J["list-style"]==="unordered"});H('button[data-event="insertOrderedList"]',function(){return J["list-style"]==="ordered"})};this.updateRecentColor=function(E,D,I){var J=g(E).closest(".note-color");var G=J.find(".note-recent-color");var F=JSON.parse(G.attr("data-value"));F[D]=I;G.attr("data-value",JSON.stringify(F));var H=D==="backColor"?"background-color":"color";G.find("i").css(H,I)}};var c=function(){var D=new m();this.update=function(E,F){D.update(E,F)};this.updateRecentColor=function(F,E,G){D.updateRecentColor(F,E,G)};this.activate=function(E){E.find("button").not('button[data-event="codeview"]').removeClass("disabled")};this.deactivate=function(E){E.find("button").not('button[data-event="codeview"]').addClass("disabled")};this.updateFullscreen=function(G,F){var E=G.find('button[data-event="fullscreen"]');E.toggleClass("active",F)};this.updateCodeview=function(G,E){var F=G.find('button[data-event="codeview"]');F.toggleClass("active",E)}};var y=function(){var E=new m();var D=function(K,J){var I=g(K);var L=J?I.offset():I.position();var H=I.outerHeight(true);return{left:L.left,top:L.top+H}};var G=function(H,I){H.css({display:"block",left:I.left,top:I.top})};var F=20;this.update=function(K,L,J){E.update(K,L);var M=K.find(".note-link-popover");if(L.anchor){var P=M.find("a");var I=g(L.anchor).attr("href");P.attr("href",I).html(I);G(M,D(L.anchor,J))}else{M.hide()}var H=K.find(".note-image-popover");if(L.image){G(H,D(L.image,J))}else{H.hide()}var N=K.find(".note-air-popover");if(J&&!L.range.isCollapsed()){var O=j.rect2bnd(z.last(L.range.getClientRects()));G(N,{left:Math.max(O.left+O.width/2-F,0),top:O.top+O.height})}else{N.hide()}};this.updateRecentColor=function(I,H,J){I.updateRecentColor(I,H,J)};this.hide=function(H){H.children().hide()}};var x=function(){this.update=function(K,I,G){var D=K.find(".note-control-selection");if(I.image){var E=g(I.image);var J=G?E.offset():E.position();var F={w:E.outerWidth(true),h:E.outerHeight(true)};D.css({display:"block",left:J.left,top:J.top,width:F.w,height:F.h}).data("target",I.image);var H=F.w+"x"+F.h;D.find(".note-control-selection-info").text(H)}else{D.hide()}};this.hide=function(D){D.children().hide()}};var h=function(){var D=function(F,E){F.toggleClass("disabled",!E);F.attr("disabled",!E)};this.showImageDialog=function(E,F){return g.Deferred(function(I){var K=F.find(".note-image-dialog");var J=F.find(".note-image-input"),G=F.find(".note-image-url"),H=F.find(".note-image-btn");K.one("shown.bs.modal",function(){J.replaceWith(J.clone().on("change",function(){I.resolve(this.files);K.modal("hide")}).val(""));H.click(function(L){L.preventDefault();I.resolve(G.val());K.modal("hide")});G.on("keyup paste",function(M){var L;if(M.type==="paste"){L=M.originalEvent.clipboardData.getData("text")}else{L=G.val()}D(H,L)}).val("").trigger("focus")}).one("hidden.bs.modal",function(){J.off("change");G.off("keyup paste");H.off("click");if(I.state()==="pending"){I.reject()}}).modal("show")})};this.showVideoDialog=function(E,F,G){return g.Deferred(function(I){var H=F.find(".note-video-dialog");var J=H.find(".note-video-url"),K=H.find(".note-video-btn");H.one("shown.bs.modal",function(){J.val(G.text).keyup(function(){D(K,J.val())}).trigger("keyup").trigger("focus");K.click(function(L){L.preventDefault();I.resolve(J.val());H.modal("hide")})}).one("hidden.bs.modal",function(){J.off("keyup");K.off("click");if(I.state()==="pending"){I.reject()}}).modal("show")})};this.showLinkDialog=function(E,G,F){return g.Deferred(function(K){var L=G.find(".note-link-dialog");var J=L.find(".note-link-text"),M=L.find(".note-link-url"),I=L.find(".note-link-btn"),H=L.find("input[type=checkbox]");L.one("shown.bs.modal",function(){J.val(F.text);J.keyup(function(){F.text=J.val()});if(!F.url){F.url=F.text;D(I,F.text)}M.keyup(function(){D(I,M.val());if(!F.text){J.val(M.val())}}).val(F.url).trigger("focus").trigger("select");H.prop("checked",F.newWindow);I.one("click",function(N){N.preventDefault();K.resolve({range:F.range,url:M.val(),text:J.val(),newWindow:H.is(":checked")});L.modal("hide")})}).one("hidden.bs.modal",function(){J.off("keyup");M.off("keyup");I.off("click");if(K.state()==="pending"){K.reject()}}).modal("show")}).promise()};this.showHelpDialog=function(E,F){return g.Deferred(function(G){var H=F.find(".note-help-dialog");H.one("hidden.bs.modal",function(){G.resolve()}).modal("show")}).promise()}};var t;if(b.hasCodeMirror){if(b.isSupportAmd){require(["CodeMirror"],function(D){t=D})}else{t=window.CodeMirror}}var l=function(){var O=g(window);var aa=g(document);var X=g("html, body");var F=new r();var N=new c(),H=new y();var Z=new x(),W=new h();var G=function(ac){var ab=g(ac).closest(".note-editor, .note-air-editor, .note-air-layout");if(!ab.length){return null}var ad;if(ab.is(".note-editor, .note-air-editor")){ad=ab}else{ad=g("#note-editor-"+z.last(ab.attr("id").split("-")))}return w.buildLayoutInfo(ad)};var D=function(ab,ad){var ac=ab.data("callbacks");if(ac.onImageUpload){ac.onImageUpload(ad,F,ab)}else{g.each(ad,function(ae,ag){var af=ag.name;i.readFileAsDataURL(ag).then(function(ah){F.insertImage(ab,ah,af)}).fail(function(){if(ac.onImageUploadError){ac.onImageUploadError()}})})}};var J={showLinkDialog:function(ag){var af=ag.editor(),ae=ag.dialog(),ab=ag.editable(),ad=F.getLinkInfo(ab);var ac=af.data("options");F.saveRange(ab);W.showLinkDialog(ab,ae,ad).then(function(ah){F.restoreRange(ab);F.createLink(ab,ah,ac);H.hide(ag.popover())}).fail(function(){F.restoreRange(ab)})},showImageDialog:function(ad){var ac=ad.dialog(),ab=ad.editable();F.saveRange(ab);W.showImageDialog(ab,ac).then(function(ae){F.restoreRange(ab);if(typeof ae==="string"){F.insertImage(ab,ae)}else{D(ab,ae)}}).fail(function(){F.restoreRange(ab)})},showVideoDialog:function(ae){var ac=ae.dialog(),ab=ae.editable(),ad=F.getVideoInfo(ab);F.saveRange(ab);W.showVideoDialog(ab,ac,ad).then(function(af){F.restoreRange(ab);F.insertVideo(ab,af)}).fail(function(){F.restoreRange(ab)})},showHelpDialog:function(ad){var ac=ad.dialog(),ab=ad.editable();F.saveRange(ab,true);W.showHelpDialog(ab,ac).then(function(){F.restoreRange(ab)})},fullscreen:function(ai){var ah=ai.editor(),af=ai.toolbar(),ac=ai.editable(),ab=ai.codable();var ae=ah.data("options");var ad=function(aj){ah.css("width",aj.w);ac.css("height",aj.h);ab.css("height",aj.h);if(ab.data("cmeditor")){ab.data("cmeditor").setsize(null,aj.h)}};ah.toggleClass("fullscreen");var ag=ah.hasClass("fullscreen");if(ag){ac.data("orgheight",ac.css("height"));O.on("resize",function(){ad({w:O.width(),h:O.height()-af.outerHeight()})}).trigger("resize");X.css("overflow","hidden")}else{O.off("resize");ad({w:ae.width||"",h:ac.data("orgheight")});X.css("overflow","visible")}N.updateFullscreen(af,ag)},codeview:function(af){var ac=af.editor(),ad=af.toolbar(),aj=af.editable(),ah=af.codable(),ag=af.popover();var ak=ac.data("options");var ab,ae;ac.toggleClass("codeview");var ai=ac.hasClass("codeview");if(ai){ah.val(w.html(aj,true));ah.height(aj.height());N.deactivate(ad);H.hide(ag);ah.focus();if(b.hasCodeMirror){ab=t.fromTextArea(ah[0],ak.codemirror);if(ak.codemirror.tern){ae=new t.TernServer(ak.codemirror.tern);ab.ternServer=ae;ab.on("cursorActivity",function(al){ae.updateArgHints(al)})}ab.setSize(null,aj.outerHeight());ah.data("cmEditor",ab)}}else{if(b.hasCodeMirror){ab=ah.data("cmEditor");ah.val(ab.getValue());ab.toTextArea()}aj.html(w.value(ah)||w.emptyPara);aj.height(ak.height?ah.height():"auto");N.activate(ad);aj.focus()}N.updateCodeview(af.toolbar(),ai)}};var M=function(ab){if(w.isImg(ab.target)){ab.preventDefault()}};var P=function(ab){setTimeout(function(){var ad=G(ab.currentTarget||ab.target);var ae=F.currentStyle(ab.target);if(!ae){return}var ac=ad.editor().data("options").airMode;if(!ac){N.update(ad.toolbar(),ae)}H.update(ad.popover(),ae,ac);Z.update(ad.handle(),ae,ac)},0)};var V=function(ab){var ac=G(ab.currentTarget||ab.target);H.hide(ac.popover());Z.hide(ac.handle())};var Q=function(ae){var ag=ae.originalEvent.clipboardData;if(!ag||!ag.items||!ag.items.length){return}var af=G(ae.currentTarget||ae.target),ab=af.editable();var ad=z.head(ag.items);var ac=ad.kind==="file"&&ad.type.indexOf("image/")!==-1;if(ac){D(ab,[ad.getAsFile()])}F.afterCommand(ab)};var I=function(ab){if(w.isControlSizing(ab.target)){ab.preventDefault();ab.stopPropagation();var ah=G(ab.target),ac=ah.handle(),aj=ah.popover(),al=ah.editable(),ad=ah.editor();var ak=ac.find(".note-control-selection").data("target"),af=g(ak),ai=af.offset(),ae=aa.scrollTop();var ag=ad.data("options").airMode;aa.on("mousemove",function(am){F.resizeTo({x:am.clientX-ai.left,y:am.clientY-(ai.top-ae)},af,!am.shiftKey);Z.update(ac,{image:ak},ag);H.update(aj,{image:ak},ag)}).one("mouseup",function(){aa.off("mousemove");F.afterCommand(al)});if(!af.data("ratio")){af.data("ratio",af.height()/af.width())}}};var U=function(ac){var ab=g(ac.target).closest("[data-event]");if(ab.length){ac.preventDefault()}};var Y=function(ab){var aj=g(ab.target).closest("[data-event]");if(aj.length){var ai=aj.attr("data-event"),ak=aj.attr("data-value"),ah=aj.attr("data-hide");var ae=G(ab.target);ab.preventDefault();var ad;if(g.inArray(ai,["resize","floatMe","removeMedia","imageShape"])!==-1){var af=ae.handle().find(".note-control-selection");ad=g(af.data("target"))}if(ah){aj.parents(".popover").hide()}if(F[ai]){var al=ae.editable();al.trigger("focus");F[ai](al,ak,ad)}else{if(J[ai]){J[ai].call(this,ae)}else{if(g.summernote.plugins[ai]){var ag=g.summernote.plugins[ai];if(g.isFunction(ag.event)){ag.event(ab,F,ae)}}}}if(g.inArray(ai,["backColor","foreColor"])!==-1){var am=ae.editor().data("options",am);var ac=am.airMode?H:N;ac.updateRecentColor(z.head(aj),ai,ak)}P(ab)}};var S=24;var L=function(ad){ad.preventDefault();ad.stopPropagation();var ab=G(ad.target).editable();var af=ab.offset().top-aa.scrollTop();var ae=G(ad.currentTarget||ad.target);var ac=ae.editor().data("options");aa.on("mousemove",function(ah){var ag=ah.clientY-(af+S);ag=(ac.minHeight>0)?Math.max(ag,ac.minHeight):ag;ag=(ac.maxHeight>0)?Math.min(ag,ac.maxHeight):ag;ab.height(ag)}).one("mouseup",function(){aa.off("mousemove")})};var R=18;var T=function(ac,ak){var ae=g(ac.target.parentNode);var ad=ae.next();var aj=ae.find(".note-dimension-picker-mousecatcher");var af=ae.find(".note-dimension-picker-highlighted");var ag=ae.find(".note-dimension-picker-unhighlighted");var ai;if(ac.offsetX===undefined){var ab=g(ac.target).offset();ai={x:ac.pageX-ab.left,y:ac.pageY-ab.top}}else{ai={x:ac.offsetX,y:ac.offsetY}}var ah={c:Math.ceil(ai.x/R)||1,r:Math.ceil(ai.y/R)||1};af.css({width:ah.c+"em",height:ah.r+"em"});aj.attr("data-value",ah.c+"x"+ah.r);if(3<ah.c&&ah.c<ak.insertTableMaxSize.col){ag.css({width:ah.c+1+"em"})}if(3<ah.r&&ah.r<ak.insertTableMaxSize.row){ag.css({height:ah.r+1+"em"})}ad.html(ah.c+" x "+ah.r)};var K=function(ac,ab){if(ab){aa.on("drop",function(ad){ad.preventDefault()})}else{E(ac)}};var E=function(ac){var ad=g(),ae=ac.dropzone,ab=ac.dropzone.find(".note-dropzone-message");aa.on("dragenter",function(ag){var af=ac.editor.hasClass("codeview");if(!af&&!ad.length){ac.editor.addClass("dragover");ae.width(ac.editor.width());ae.height(ac.editor.height());ab.text("Drag Image Here")}ad=ad.add(ag.target)}).on("dragleave",function(af){ad=ad.not(af.target);if(!ad.length){ac.editor.removeClass("dragover")}}).on("drop",function(){ad=g();ac.editor.removeClass("dragover")});ae.on("dragenter",function(){ae.addClass("hover");ab.text("Drop Image")}).on("dragleave",function(){ae.removeClass("hover");ab.text("Drag Image Here")});ae.on("drop",function(af){af.preventDefault();var ag=af.originalEvent.dataTransfer;if(ag&&ag.files){var ah=G(af.currentTarget||af.target);ah.editable().focus();D(ah.editable(),ag.files)}}).on("dragover",false)};this.bindKeyMap=function(ad,ae){var ac=ad.editor;var ab=ad.editable;ad=G(ab);ab.on("keydown",function(aj){var ai=[];if(aj.metaKey){ai.push("CMD")}if(aj.ctrlKey&&!aj.altKey){ai.push("CTRL")}if(aj.shiftKey){ai.push("SHIFT")}var ag=C.nameFromCode[aj.keyCode];if(ag){ai.push(ag)}var af=ae[ai.join("+")];if(af){aj.preventDefault();if(F[af]){F[af](ab,ac.data("options"))}else{if(J[af]){J[af].call(this,ad)}else{if(g.summernote.plugins[af]){var ah=g.summernote.plugins[af];if(g.isFunction(ah.event)){ah.event(aj,F,ad)}}}}}else{if(C.isEdit(aj.keyCode)){F.afterCommand(ab)}}})};this.attach=function(ag,ac){this.bindKeyMap(ag,ac.keyMap[b.isMac?"mac":"pc"]);ag.editable.on("mousedown",M);ag.editable.on("keyup mouseup",P);ag.editable.on("scroll",V);ag.editable.on("paste",Q);ag.handle.on("mousedown",I);ag.popover.on("click",Y);ag.popover.on("mousedown",U);if(!ac.airMode){K(ag,ac.disableDragAndDrop);ag.toolbar.on("click",Y);ag.toolbar.on("mousedown",U);if(!ac.disableResizeEditor){ag.statusbar.on("mousedown",L)}}var ab=ac.airMode?ag.popover:ag.toolbar;var ah=ab.find(".note-dimension-picker-mousecatcher");ah.css({width:ac.insertTableMaxSize.col+"em",height:ac.insertTableMaxSize.row+"em"}).on("mousemove",function(ai){T(ai,ac)});ag.editor.data("options",ac);if(ac.styleWithSpan&&!b.isMSIE){setTimeout(function(){document.execCommand("styleWithCSS",0,true)},0)}var af=new d(ag.editable);ag.editable.data("NoteHistory",af);if(ac.onenter){ag.editable.keypress(function(ai){if(ai.keyCode===C.ENTER){ac.onenter(ai)}})}if(ac.onfocus){ag.editable.focus(ac.onfocus)}if(ac.onblur){ag.editable.blur(ac.onblur)}if(ac.onkeyup){ag.editable.keyup(ac.onkeyup)}if(ac.onkeydown){ag.editable.keydown(ac.onkeydown)}if(ac.onpaste){ag.editable.on("paste",ac.onpaste)}if(ac.onToolbarClick){ag.toolbar.click(ac.onToolbarClick)}if(ac.onChange){var ad=function(){F.triggerOnChange(ag.editable)};if(b.isMSIE){var ae="DOMCharacterDataModified DOMSubtreeModified DOMNodeInserted";ag.editable.on(ae,ad)}else{ag.editable.on("input",ad)}}ag.editable.data("callbacks",{onChange:ac.onChange,onAutoSave:ac.onAutoSave,onImageUpload:ac.onImageUpload,onImageUploadError:ac.onImageUploadError,onFileUpload:ac.onFileUpload,onFileUploadError:ac.onFileUpload})};this.dettach=function(ac,ab){ac.editable.off();ac.popover.off();ac.handle.off();ac.dialog.off();if(!ab.airMode){ac.dropzone.off();ac.toolbar.off();ac.statusbar.off()}}};var s=function(){var G=function(Z,Y){var ac=Y.event;var ad=Y.value;var ae=Y.title;var ab=Y.className;var af=Y.dropdown;var aa=Y.hide;return'<button type="button" class="btn btn-default btn-sm btn-small'+(ab?" "+ab:"")+(af?" dropdown-toggle":"")+'"'+(af?' data-toggle="dropdown"':"")+(ae?' title="'+ae+'"':"")+(ac?' data-event="'+ac+'"':"")+(ad?" data-value='"+ad+"'":"")+(aa?" data-hide='"+aa+"'":"")+' tabindex="-1">'+Z+(af?' <span class="caret"></span>':"")+"</button>"+(af||"")};var K=function(aa,Z){var Y='<i class="'+aa+'"></i>';return G(Y,Z)};var P=function(Y,Z){return'<div class="'+Y+' popover bottom in" style="display: none;"><div class="arrow"></div><div class="popover-content">'+Z+"</div></div>"};var X=function(Z,aa,Y,ab){return'<div class="'+Z+' modal" aria-hidden="false"><div class="modal-dialog"><div class="modal-content">'+(aa?'<div class="modal-header"><button type="button" class="close" aria-hidden="true" tabindex="-1">&times;</button><h4 class="modal-title">'+aa+"</h4></div>":"")+'<form class="note-modal-form"><div class="modal-body"><div class="row-fluid">'+Y+"</div></div>"+(ab?'<div class="modal-footer">'+ab+"</div>":"")+"</form></div></div></div>"};var T={picture:function(Y){return K("fa fa-picture-o icon-picture",{event:"showImageDialog",title:Y.image.image,hide:true})},link:function(Y){return K("fa fa-link icon-link",{event:"showLinkDialog",title:Y.link.link,hide:true})},video:function(Y){return K("fa fa-youtube-play icon-play",{event:"showVideoDialog",title:Y.video.video,hide:true})},table:function(Y){var Z='<ul class="note-table dropdown-menu"><div class="note-dimension-picker"><div class="note-dimension-picker-mousecatcher" data-event="insertTable" data-value="1x1"></div><div class="note-dimension-picker-highlighted"></div><div class="note-dimension-picker-unhighlighted"></div></div><div class="note-dimension-display"> 1 x 1 </div></ul>';return K("fa fa-table icon-table",{title:Y.table.table,dropdown:Z})},style:function(aa,Z){var Y=Z.styleTags.reduce(function(ac,ab){var ad=aa.style[ab==="p"?"normal":ab];return ac+'<li><a data-event="formatBlock" href="#" data-value="'+ab+'">'+((ab==="p"||ab==="pre")?ad:"<"+ab+">"+ad+"</"+ab+">")+"</a></li>"},"");return K("fa fa-magic icon-magic",{title:aa.style.style,dropdown:'<ul class="dropdown-menu">'+Y+"</ul>"})},fontname:function(ab,aa){var Y=aa.fontNames.reduce(function(ad,ac){if(!b.isFontInstalled(ac)){return ad}return ad+'<li><a data-event="fontName" href="#" data-value="'+ac+'"><i class="fa fa-check icon-ok"></i> '+ac+"</a></li>"},"");var Z='<span class="note-current-fontname">'+aa.defaultFontName+"</span>";return G(Z,{title:ab.font.name,dropdown:'<ul class="dropdown-menu">'+Y+"</ul>"})},fontsize:function(ab,aa){var Y=aa.fontSizes.reduce(function(ad,ac){return ad+'<li><a data-event="fontSize" href="#" data-value="'+ac+'"><i class="fa fa-check icon-ok"></i> '+ac+"</a></li>"},"");var Z='<span class="note-current-fontsize">11</span>';return G(Z,{title:ab.font.size,dropdown:'<ul class="dropdown-menu">'+Y+"</ul>"})},color:function(ab){var aa='<i class="fa fa-font icon-font" style="color:black;background-color:yellow;"></i>';var Y=G(aa,{className:"note-recent-color",title:ab.color.recent,event:"color",value:'{"backColor":"yellow"}'});var ac='<ul class="dropdown-menu"><li><div class="btn-group"><div class="note-palette-title">'+ab.color.background+'</div><div class="note-color-reset" data-event="backColor" data-value="inherit" title="'+ab.color.transparent+'">'+ab.color.setTransparent+'</div><div class="note-color-palette" data-target-event="backColor"></div></div><div class="btn-group"><div class="note-palette-title">'+ab.color.foreground+'</div><div class="note-color-reset" data-event="foreColor" data-value="inherit" title="'+ab.color.reset+'">'+ab.color.resetToDefault+'</div><div class="note-color-palette" data-target-event="foreColor"></div></div></li></ul>';var Z=G("",{title:ab.color.more,dropdown:ac});return Y+Z},bold:function(Y){return K("fa fa-bold icon-bold",{event:"bold",title:Y.font.bold})},italic:function(Y){return K("fa fa-italic icon-italic",{event:"italic",title:Y.font.italic})},underline:function(Y){return K("fa fa-underline icon-underline",{event:"underline",title:Y.font.underline})},strikethrough:function(Y){return K("fa fa-strikethrough icon-strikethrough",{event:"strikethrough",title:Y.font.strikethrough})},superscript:function(Y){return K("fa fa-superscript icon-superscript",{event:"superscript",title:Y.font.superscript})},subscript:function(Y){return K("fa fa-subscript icon-subscript",{event:"subscript",title:Y.font.subscript})},clear:function(Y){return K("fa fa-eraser icon-eraser",{event:"removeFormat",title:Y.font.clear})},ul:function(Y){return K("fa fa-list-ul icon-list-ul",{event:"insertUnorderedList",title:Y.lists.unordered})},ol:function(Y){return K("fa fa-list-ol icon-list-ol",{event:"insertOrderedList",title:Y.lists.ordered})},paragraph:function(ae){var aa=K("fa fa-align-left icon-align-left",{title:ae.paragraph.left,event:"justifyLeft"});var ad=K("fa fa-align-center icon-align-center",{title:ae.paragraph.center,event:"justifyCenter"});var ab=K("fa fa-align-right icon-align-right",{title:ae.paragraph.right,event:"justifyRight"});var ac=K("fa fa-align-justify icon-align-justify",{title:ae.paragraph.justify,event:"justifyFull"});var Z=K("fa fa-outdent icon-indent-left",{title:ae.paragraph.outdent,event:"outdent"});var Y=K("fa fa-indent icon-indent-right",{title:ae.paragraph.indent,event:"indent"});var af='<div class="dropdown-menu"><div class="note-align btn-group">'+aa+ad+ab+ac+'</div><div class="note-list btn-group">'+Y+Z+"</div></div>";return K("fa fa-align-left icon-align-left",{title:ae.paragraph.paragraph,dropdown:af})},height:function(aa,Z){var Y=Z.lineHeights.reduce(function(ac,ab){return ac+'<li><a data-event="lineHeight" href="#" data-value="'+parseFloat(ab)+'"><i class="fa fa-check icon-ok"></i> '+ab+"</a></li>"},"");return K("fa fa-text-height icon-text-height",{title:aa.font.height,dropdown:'<ul class="dropdown-menu">'+Y+"</ul>"})},help:function(Y){return K("fa fa-question icon-question",{event:"showHelpDialog",title:Y.options.help,hide:true})},fullscreen:function(Y){return K("fa fa-arrows-alt icon-fullscreen",{event:"fullscreen",title:Y.options.fullscreen})},codeview:function(Y){return K("fa fa-code icon-code",{event:"codeview",title:Y.options.codeview})},undo:function(Y){return K("fa fa-undo icon-undo",{event:"undo",title:Y.history.undo})},redo:function(Y){return K("fa fa-repeat icon-repeat",{event:"redo",title:Y.history.redo})},hr:function(Y){return K("fa fa-minus icon-hr",{event:"insertHorizontalRule",title:Y.hr.insert})}};var H=function(ac,Y){var ab=function(){var ad=K("fa fa-edit icon-edit",{title:ac.link.edit,event:"showLinkDialog",hide:true});var af=K("fa fa-unlink icon-unlink",{title:ac.link.unlink,event:"unlink"});var ae='<a href="http://www.google.com" target="_blank">www.google.com</a>&nbsp;&nbsp;<div class="note-insert btn-group">'+ad+af+"</div>";return P("note-link-popover",ae)};var aa=function(){var af=G('<span class="note-fontsize-10">100%</span>',{title:ac.image.resizeFull,event:"resize",value:"1"});var ad=G('<span class="note-fontsize-10">50%</span>',{title:ac.image.resizeHalf,event:"resize",value:"0.5"});var ak=G('<span class="note-fontsize-10">25%</span>',{title:ac.image.resizeQuarter,event:"resize",value:"0.25"});var ae=K("fa fa-align-left icon-align-left",{title:ac.image.floatLeft,event:"floatMe",value:"left"});var am=K("fa fa-align-right icon-align-right",{title:ac.image.floatRight,event:"floatMe",value:"right"});var aj=K("fa fa-align-justify icon-align-justify",{title:ac.image.floatNone,event:"floatMe",value:"none"});var ag=K("fa fa-square icon-unchecked",{title:ac.image.shapeRounded,event:"imageShape",value:"img-rounded"});var an=K("fa fa-circle-o icon-circle-blank",{title:ac.image.shapeCircle,event:"imageShape",value:"img-circle"});var ai=K("fa fa-picture-o icon-picture",{title:ac.image.shapeThumbnail,event:"imageShape",value:"img-thumbnail"});var ao=K("fa fa-times icon-times",{title:ac.image.shapeNone,event:"imageShape",value:""});var ah=K("fa fa-trash-o icon-trash",{title:ac.image.remove,event:"removeMedia",value:"none"});var al='<div class="btn-group">'+af+ad+ak+'</div><div class="btn-group">'+ae+am+aj+'</div><div class="btn-group">'+ag+an+ai+ao+'</div><div class="btn-group">'+ah+"</div>";return P("note-image-popover",al)};var Z=function(){var ag="";for(var ae=0,ad=Y.airPopover.length;ae<ad;ae++){var ai=Y.airPopover[ae];ag+='<div class="note-'+ai[0]+' btn-group">';for(var af=0,ah=ai[1].length;af<ah;af++){ag+=T[ai[1][af]](ac,Y)}ag+="</div>"}return P("note-air-popover",ag)};return'<div class="note-popover">'+ab()+aa()+(Y.airMode?Z():"")+"</div>"};var W=function(){return'<div class="note-handle"><div class="note-control-selection"><div class="note-control-selection-bg"></div><div class="note-control-holder note-control-nw"></div><div class="note-control-holder note-control-ne"></div><div class="note-control-holder note-control-sw"></div><div class="note-control-sizing note-control-se"></div><div class="note-control-selection-info"></div></div></div>'};var N=function(Z,Y){return'<table class="note-shortcut"><thead><tr><th></th><th>'+Z+"</th></tr></thead><tbody>"+Y+"</tbody></table>"};var D=function(Z){var Y="<tr><td>⌘ + B</td><td>"+Z.font.bold+"</td></tr><tr><td>⌘ + I</td><td>"+Z.font.italic+"</td></tr><tr><td>⌘ + U</td><td>"+Z.font.underline+"</td></tr><tr><td>⌘ + ⇧ + S</td><td>"+Z.font.strikethrough+"</td></tr><tr><td>⌘ + \\</td><td>"+Z.font.clear+"</td></tr>";return N(Z.shortcut.textFormatting,Y)};var V=function(Z){var Y="<tr><td>⌘ + Z</td><td>"+Z.history.undo+"</td></tr><tr><td>⌘ + ⇧ + Z</td><td>"+Z.history.redo+"</td></tr><tr><td>⌘ + ]</td><td>"+Z.paragraph.indent+"</td></tr><tr><td>⌘ + [</td><td>"+Z.paragraph.outdent+"</td></tr><tr><td>⌘ + ENTER</td><td>"+Z.hr.insert+"</td></tr>";return N(Z.shortcut.action,Y)};var Q=function(Z){var Y="<tr><td>⌘ + ⇧ + L</td><td>"+Z.paragraph.left+"</td></tr><tr><td>⌘ + ⇧ + E</td><td>"+Z.paragraph.center+"</td></tr><tr><td>⌘ + ⇧ + R</td><td>"+Z.paragraph.right+"</td></tr><tr><td>⌘ + ⇧ + J</td><td>"+Z.paragraph.justify+"</td></tr><tr><td>⌘ + ⇧ + NUM7</td><td>"+Z.lists.ordered+"</td></tr><tr><td>⌘ + ⇧ + NUM8</td><td>"+Z.lists.unordered+"</td></tr>";return N(Z.shortcut.paragraphFormatting,Y)};var S=function(Z){var Y="<tr><td>⌘ + NUM0</td><td>"+Z.style.normal+"</td></tr><tr><td>⌘ + NUM1</td><td>"+Z.style.h1+"</td></tr><tr><td>⌘ + NUM2</td><td>"+Z.style.h2+"</td></tr><tr><td>⌘ + NUM3</td><td>"+Z.style.h3+"</td></tr><tr><td>⌘ + NUM4</td><td>"+Z.style.h4+"</td></tr><tr><td>⌘ + NUM5</td><td>"+Z.style.h5+"</td></tr><tr><td>⌘ + NUM6</td><td>"+Z.style.h6+"</td></tr>";return N(Z.shortcut.documentStyle,Y)};var I=function(ac,Z){var ab=Z.extraKeys;var Y="";for(var aa in ab){if(ab.hasOwnProperty(aa)){Y+="<tr><td>"+aa+"</td><td>"+ab[aa]+"</td></tr>"}}return N(ac.shortcut.extraKeys,Y)};var U=function(aa,Y){var Z='<table class="note-shortcut-layout"><tbody><tr><td>'+V(aa,Y)+"</td><td>"+D(aa,Y)+"</td></tr><tr><td>"+S(aa,Y)+"</td><td>"+Q(aa,Y)+"</td></tr>";if(Y.extraKeys){Z+='<tr><td colspan="2">'+I(aa,Y)+"</td></tr>"}Z+="</tbody></table>";return Z};var O=function(Y){return Y.replace(/⌘/g,"Ctrl").replace(/⇧/g,"Shift")};var E=function(ad,Y){var ab=function(){var ae='<div class="note-group-select-from-files"><h5>'+ad.image.selectFromFiles+'</h5><input class="note-image-input" type="file" name="files" accept="image/*" /></div><h5>'+ad.image.url+'</h5><input class="note-image-url form-control span12" type="text" />';var af='<button href="#" class="btn btn-primary note-image-btn disabled" disabled>'+ad.image.insert+"</button>";return X("note-image-dialog",ad.image.insert,ae,af)};var Z=function(){var ae='<div class="form-group"><label>'+ad.link.textToDisplay+'</label><input class="note-link-text form-control span12" type="text" /></div><div class="form-group"><label>'+ad.link.url+'</label><input class="note-link-url form-control span12" type="text" /></div>'+(!Y.disableLinkTarget?'<div class="checkbox"><label><input type="checkbox" checked> '+ad.link.openInNewWindow+"</label></div>":"");var af='<button href="#" class="btn btn-primary note-link-btn disabled" disabled>'+ad.link.insert+"</button>";return X("note-link-dialog",ad.link.insert,ae,af)};var aa=function(){var ae='<div class="form-group"><label>'+ad.video.url+'</label>&nbsp;<small class="text-muted">'+ad.video.providers+'</small><input class="note-video-url form-control span12" type="text" /></div>';var af='<button href="#" class="btn btn-primary note-video-btn disabled" disabled>'+ad.video.insert+"</button>";return X("note-video-dialog",ad.video.insert,ae,af)};var ac=function(){var ae='<a class="modal-close pull-right" aria-hidden="true" tabindex="-1">'+ad.shortcut.close+'</a><div class="title">'+ad.shortcut.shortcuts+"</div>"+(b.isMac?U(ad,Y):O(U(ad,Y)))+'<p class="text-center"><a href="//hackerwins.github.io/summernote/" target="_blank">Summernote 0.5.10</a> · <a href="//github.com/HackerWins/summernote" target="_blank">Project</a> · <a href="//github.com/HackerWins/summernote/issues" target="_blank">Issues</a></p>';return X("note-help-dialog","",ae,"")};return'<div class="note-dialog">'+ab()+Z()+aa()+ac()+"</div>"};var M=function(){return'<div class="note-resizebar"><div class="note-icon-bar"></div><div class="note-icon-bar"></div><div class="note-icon-bar"></div></div>'};var L=function(Y){if(b.isMac){Y=Y.replace("CMD","⌘").replace("SHIFT","⇧")}return Y.replace("BACKSLASH","\\").replace("SLASH","/").replace("LEFTBRACKET","[").replace("RIGHTBRACKET","]")};var R=function(ab,ac,Y){var aa=j.invertObject(ac);var Z=ab.find("button");Z.each(function(ae,ag){var af=g(ag);var ad=aa[af.data("event")];if(ad){af.attr("title",function(ai,ah){return ah+" ("+L(ad)+")"})}}).tooltip({container:"body",trigger:"hover",placement:Y||"top"}).on("click",function(){g(this).tooltip("hide")})};var J=function(aa,Y){var Z=Y.colors;aa.find(".note-color-palette").each(function(){var ah=g(this),af=ah.attr("data-target-event");var ad=[];for(var ak=0,ag=Z.length;ak<ag;ak++){var ab=Z[ak];var ai=[];for(var ac=0,aj=ab.length;ac<aj;ac++){var ae=ab[ac];ai.push(['<button type="button" class="note-color-btn" style="background-color:',ae,';" data-event="',af,'" data-value="',ae,'" title="',ae,'" data-toggle="button" tabindex="-1"></button>'].join(""))}ad.push('<div class="note-color-row">'+ai.join("")+"</div>")}ah.html(ad.join(""))})};var F=function(Z,Y){return function(){var aa={title:Y.title,className:Y.className,dropdown:g.isFunction(Y.dropdown)?Y.dropdown():Y.dropdown,hide:Y.hide,event:(!Y.dropdown)?Z:"",value:(!Y.dropdown)?Z:""};if(Y.icon){return K(Y.icon,aa)}else{return G(Y.label,aa)}}};this.createLayoutByAirMode=function(ab,ag){var ae=ag.keyMap[b.isMac?"mac":"pc"];var af=g.extend(g.summernote.lang["en-US"],g.summernote.lang[ag.lang]);var Y=j.uniqueId();ab.addClass("note-air-editor note-editable");ab.attr({id:"note-editor-"+Y,contentEditable:true});var ad=document.body;var ac=g(H(af,ag));ac.addClass("note-air-layout");ac.attr("id","note-popover-"+Y);ac.appendTo(ad);R(ac,ae);J(ac,ag);var Z=g(W());Z.addClass("note-air-layout");Z.attr("id","note-handle-"+Y);Z.appendTo(ad);var aa=g(E(af,ag));aa.addClass("note-air-layout");aa.attr("id","note-dialog-"+Y);aa.find("button.close, a.modal-close").click(function(){g(this).closest(".modal").modal("hide")});aa.appendTo(ad)};this.createLayoutByFrame=function(ai,Y){var ab=g('<div class="note-editor"></div>');if(Y.width){ab.width(Y.width)}if(Y.height>0){g('<div class="note-statusbar">'+(Y.disableResizeEditor?"":M())+"</div>").prependTo(ab)}var am=!ai.is(":disabled");var ao=g('<div class="note-editable" contentEditable="'+am+'"></div>').prependTo(ab);if(Y.height){ao.height(Y.height)}if(Y.direction){ao.attr("dir",Y.direction)}ao.html(w.html(ai)||w.emptyPara);g('<textarea class="note-codable"></textarea>').prependTo(ab);var ak=g.extend(g.summernote.lang["en-US"],g.summernote.lang[Y.lang]);var ag="";for(var ae=0,al=Y.toolbar.length;ae<al;ae++){var ac=Y.toolbar[ae][0];var ad=Y.toolbar[ae][1];ag+='<div class="note-'+ac+' btn-group">';for(var aj=0,af=ad.length;aj<af;aj++){var aa=T[ad[aj]];if(!aa&&!!g.summernote.plugins[ad[aj]]){aa=F(ad[aj],g.summernote.plugins[ad[aj]])}if(!g.isFunction(aa)){continue}ag+=aa(ak,Y)}ag+="</div>"}ag='<div class="note-toolbar btn-toolbar">'+ag+"</div>";var ap=g(ag).prependTo(ab);var ah=Y.keyMap[b.isMac?"mac":"pc"];J(ap,Y);R(ap,ah,"bottom");var Z=g(H(ak,Y)).prependTo(ab);J(Z,Y);R(Z,ah);g(W()).prependTo(ab);var an=g(E(ak,Y)).prependTo(ab);an.find("button.close, a.modal-close").click(function(){g(this).closest(".modal").modal("hide")});g('<div class="note-dropzone"><div class="note-dropzone-message"></div></div>').prependTo(ab);ab.insertAfter(ai);ai.hide()};this.noteEditorFromHolder=function(Y){if(Y.hasClass("note-air-editor")){return Y}else{if(Y.next().hasClass("note-editor")){return Y.next()}else{return g()}}};this.createLayout=function(Z,Y){if(this.noteEditorFromHolder(Z).length){return}if(Y.airMode){this.createLayoutByAirMode(Z,Y)}else{this.createLayoutByFrame(Z,Y)}};this.layoutInfoFromHolder=function(Z){var ab=this.noteEditorFromHolder(Z);if(!ab.length){return}var aa=w.buildLayoutInfo(ab);for(var Y in aa){if(aa.hasOwnProperty(Y)){aa[Y]=aa[Y].call()}}return aa};this.removeLayout=function(Z,aa,Y){if(Y.airMode){Z.removeClass("note-air-editor note-editable").removeAttr("id contentEditable");aa.popover.remove();aa.handle.remove();aa.dialog.remove()}else{Z.html(aa.editable.html());aa.editor.remove();Z.show()}}};g.summernote=g.summernote||{};g.extend(g.summernote,A);var q=new s();var v=new l();g.fn.extend({summernote:function(D){D=g.extend({},g.summernote.options,D);this.each(function(F,G){var H=g(G);q.createLayout(H,D);var I=q.layoutInfoFromHolder(H);v.attach(I,D);if(w.isTextarea(H[0])){H.closest("form").submit(function(){H.val(H.code())})}});if(this.first().length&&D.focus){var E=q.layoutInfoFromHolder(this.first());E.editable.focus()}if(this.length&&D.oninit){D.oninit()}return this},code:function(E){if(E===undefined){var F=this.first();if(!F.length){return}var G=q.layoutInfoFromHolder(F);if(!!(G&&G.editable)){var D=G.editor.hasClass("codeview");if(D&&b.hasCodeMirror){G.codable.data("cmEditor").save()}return D?G.codable.val():G.editable.html()}return w.isTextarea(F[0])?F.val():F.html()}this.each(function(H,I){var J=q.layoutInfoFromHolder(g(I));if(J&&J.editable){J.editable.html(E)}});return this},destroy:function(){this.each(function(D,F){var G=g(F);var H=q.layoutInfoFromHolder(G);if(!H||!H.editable){return}var E=H.editor.data("options");v.dettach(H,E);q.removeLayout(G,H,E)});return this}})}));